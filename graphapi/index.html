<html><head><title>Login and GraphAPI</title>
    <!-- msal.min.js can be used in the place of msal.js; included msal.js to make debug easy -->
    <script src="https://alcdn.msauth.net/browser/2.1.0/js/msal-browser.js" integrity="sha384-M9bRB06LdiYadS+F9rPQnntFCYR3UJvtb2Vr4Tmhw9WBwWUfxH8VDRAFKNn3VTc/" crossorigin="anonymous"></script>
</head>

<body>

<h1>Login and call MS GraphAPI example</h1>

<p>
    This page tests first logging user in, and then calling MS Graph API with acquired user credentials 
    to get details about the user. <b>signIn() and signOut()</b> functions are defined in 
    <b>authRedirect.js</b> file. Notices: I've hardcoded signIn() and getUserdata() callbacks 
    in authRedirect.js as <b>loginCallback() &amp; myInfoReceivedCallback()</b>,
    which both are defined in this index.html file. You may want to change that in your own implementation.
</p>

<hr>

<h3>Account info</h3>

<code><span id="accountinfo">Not logged in yet. <a href="javascript:signIn();">Click here to sign in</a>!</span></code>

<h3>User basic Info from MS GraphAPI</h3>

<code><span id="myinfo">No info yet. Login, and then <a href="javascript:seeProfile();">Click here</a> to call MS Graph API to get logged in user information.</span></code>

<hr>
<p>
    <a href="javascript:signOut();">Click here to sign out</a><br>
    <a href="../">Back to top</a>
</p>


<!-- importing app scripts (load order is important) -->
<script type="text/javascript" src="./authConfig.js"></script>

<!-- 
These examples uses redirect-method (the other option would have been using popup window for login)
If you'd like to use the popup, see MS example on how to use this: https://github.com/Azure-Samples/ms-identity-javascript-v2
-->
<script type="text/javascript" src="./authRedirect.js"></script>

<script>

    // Callback for login
    function loginCallback(account) {

        // Show the response account json object we get as result
        var accountAsString = JSON.stringify(account, null, 2); // spacing level = 2
        document.getElementById("accountinfo").textContent=accountAsString;
    }

    function myInfoReceivedCallback(data) {

        var infoAsString = JSON.stringify(data, null, 2); // spacing level = 2
        document.getElementById("myinfo").textContent=infoAsString;
    }

</script>


</body>
</html>